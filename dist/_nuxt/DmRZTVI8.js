import{_ as G}from"./CuDQHfdM.js";import{K as J,u as Q,m as X,r as n,q as Y,v as t,c as b,a as e,d as w,t as o,D as Z,I as y,L as ee,H as k,M as te,x as ae,b as d,w as x,y as se,F as oe,o as M,T as L,N as le,z as ne,E as ie}from"./B4Idg1NY.js";import{_ as R}from"./C1IqibHs.js";import{s as re}from"./DBZ0GZbc.js";const de={key:0,class:"login_container"},ce={class:"login"},_e={class:"login_tit"},ue={class:"login_input"},me={for:"login_account"},pe=["placeholder"],ge={class:"login_input input-group"},fe={class:"mt-3",for:"login_password"},he=["type","placeholder"],xe={class:"fs-6 mt-1 login_input text-end"},ve={class:"login_btn"},be={class:"modal fade resetPW",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},we={class:"modal-dialog modal-dialog-centered",style:{"max-width":"650px"}},ye={class:"modal-header d-block text-center border-0 pb-0"},ke={class:"modal-title",id:"exampleModalLabel",style:{"letter-spacing":"5px"}},Me={class:"fs-6 text-black-50 mt-2"},Ve={class:"modal-body",key:"2"},Se={class:"d-block mb-3"},Te={class:"modal-footer border-0 justify-content-center pb-4"},De=["disabled"],Fe={class:"modal-body text-center",key:"3"},Ce={style:{"letter-spacing":"2px"}},Ee={class:"modal-footer border-0 justify-content-center pt-4"},$e={__name:"index",setup(je){const{executeRecaptcha:z,recaptchaLoaded:O}=J(),a=Q(),W=X(),V=n(""),u=n(""),m=n(""),p=n(!1),g=n(""),v=n(!1),f=n(""),c=n(!1),S=n(""),T=()=>{p.value=!p.value},H=async()=>{c.value=!0,a.show_loading(!0),await O();const r=await z("login");V.value=r,await I(),c.value=!1,a.show_loading(!1)},I=async()=>{const r=re(m.value.toString());let s=`${a.baseUrl}api/v2/login?email=${u.value}&password=${r}`;const i={"google-recaptcha-v3-token":V.value};try{const l=await fetch(s,{method:"POST",body:a.jsonToFormData(i)}),_=await l.json();l.ok&&!_.error?(await a.set_token(_),W.push("/home")):alert(_.error)}catch(l){console.log(l)}},K=async()=>{a.show_loading(!0),c.value=!0;const r=`${a.baseUrl}api/v2/password/email`;let s=new FormData;s.append("email",g.value);try{const i=await fetch(r,{method:"POST",body:s}),l=await i.json();i.ok?(v.value=!0,S.value=l.success,f.value=""):f.value=l.error}catch(i){console.log(i)}c.value=!1,a.show_loading(!1)};return Y(async()=>{a.show_loading(!1)}),(r,s)=>{var D,F,C,E,j,q;const i=G,l=ne,_=ie,A=oe;return t(a).language_txt?(M(),b("div",de,[e("div",ce,[e("div",_e,[s[4]||(s[4]=e("img",{class:"login_logo",src:R,alt:"logo"},null,-1)),w(" "+o((D=t(a).language_txt.auth)==null?void 0:D.text_login),1)]),e("form",{id:"login",class:"mt-3",onSubmit:Z(H,["prevent"])},[e("div",ue,[e("label",me,o((F=t(a).language_txt.auth)==null?void 0:F.column_email),1),y(e("input",{class:"form-control",type:"email",id:"login_account",placeholder:(C=t(a).language_txt.auth)==null?void 0:C.text_input_email,"onUpdate:modelValue":s[0]||(s[0]=h=>k(u)?u.value=h:null),required:""},null,8,pe),[[ee,t(u)]])]),e("div",ge,[e("label",fe,o((E=t(a).language_txt.auth)==null?void 0:E.column_password),1),y(e("input",{class:"form-control",type:t(p)?"text":"password",id:"login_password",placeholder:(j=t(a).language_txt.auth)==null?void 0:j.column_password,"onUpdate:modelValue":s[1]||(s[1]=h=>k(m)?m.value=h:null),autocomplete:"off",required:""},null,8,he),[[te,t(m)]]),e("span",{class:"input-group-text",onMousedown:T,onMouseup:T},[e("i",{class:ae(["fas",t(p)?"fa-eye-slash":"fa-eye"])},null,2)],32)]),e("div",xe,[s[5]||(s[5]=e("i",{class:"fas fa-question-circle"},null,-1)),d(i,{to:"/",class:"ms-1","data-bs-toggle":"modal","data-bs-target":"#exampleModal",style:{"text-decoration":"underline"}},{default:x(()=>[w(o(t(a).language_txt.auth.text_forget_password),1)]),_:1})]),e("button",ve,o((q=t(a).language_txt)==null?void 0:q.auth.text_login),1)],32)]),s[7]||(s[7]=e("div",{class:"login_bg"},[e("img",{class:"login_logo",src:R,alt:"logo"})],-1)),e("div",be,[e("div",we,[d(A,{class:"modal-content px-4",onSubmit:K},{default:x(({errors:h})=>{var N;return[e("div",ye,[e("h2",ke,o((N=t(a).language_txt.auth)==null?void 0:N.text_reset_password),1),e("p",Me,o(t(a).language_txt.auth.text_verification_sending),1)]),d(L,{name:"fade",mode:"out-in"},{default:x(()=>[y(e("div",{class:"bg-danger text-white text-center p-1 fs-6",key:"1"},o(t(f)),513),[[le,t(f)]])]),_:1}),d(L,{name:"fade",mode:"out-in"},{default:x(()=>{var P,U,$;return[t(v)?(M(),b("div",Fe,[s[6]||(s[6]=e("i",{class:"far fa-check-circle me-2",style:{color:"#63E6BE"}},null,-1)),e("span",Ce,o(t(S)),1),e("div",Ee,[e("span",{class:"btn sent_go","data-bs-dismiss":"modal","aria-label":"Close",onClick:s[3]||(s[3]=B=>v.value=!1)},o(t(a).language_txt.default.text_close),1)])])):(M(),b("div",Ve,[e("label",Se,[w(o((P=t(a).language_txt.auth)==null?void 0:P.column_email)+" ",1),d(l,{type:"email",name:"reset_pw_email",class:"form-control mt-2",modelValue:t(g),"onUpdate:modelValue":s[2]||(s[2]=B=>k(g)?g.value=B:null),placeholder:(U=t(a).language_txt.auth)==null?void 0:U.text_input_email,rules:"required|email"},null,8,["modelValue","placeholder"]),d(_,{class:"error__label fs-xs",name:"reset_pw_email"})]),e("div",Te,[e("button",{type:"submit",class:"btn sent_go",disabled:t(c)},o(($=t(a).language_txt.auth)==null?void 0:$.text_reset_password),9,De)])]))]}),_:1})]}),_:1})])])])):se("",!0)}}};export{$e as default};
